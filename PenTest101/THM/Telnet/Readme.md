# Telnet

- [About](#about)
- [Enumeration](#enumeration)
  - [Nmap](#nmap)
- [Exploitation](#exploitation)

## About:

- What is Telnet?
  A protocol that allows us to connect and execute commands on a remote machine hosting a telnet server through the use of a telnet client.

  The client will establish a connection with the server and become a virtual terminal allowing us to interact.

  Telnet sends all messages in clear text and has no specific security mechanism. Because of this, Telnet was replaced by SSH in most instances.

- How does it work?
  The user connects to a server using the Telnet protocol. By entering _"telnet"_ into a terminal.  
  One can connect with the following syntax: **telnet [ip] [port]**

## Enumeration

### Nmap

- Input
  A basic scan
  ```bash
  nmap -A -oA  -vv 10.10.124.182
  ```
- Output

  ```bash
  # Nmap 7.60 scan initiated Tue Apr 27 19:34:14 2021 as: nmap -A -oA nmap/1k_ports -vv 10.10.124.182
  adjust_timeouts2: packet supposedly had rtt of -101322 microseconds. Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -101322 microseconds. Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -150043 microseconds. Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -150043 microseconds. Ignoring time.
  Nmap scan report for ip-10-10-124-182.eu-west-1.compute.internal (10.10.124.182)
  Host is up, received arp-response (0.00084s latency).
  All 1000 scanned ports on ip-10-10-124-182.eu-west-1.compute.internal (10.10.124.182) are closed because of 1000 resets
  MAC Address: 02:57:43:51:12:55 (Unknown)
  Too many fingerprints match this host to give specific OS details
  TCP/IP fingerprint:
  SCAN(V=7.60%E=4%D=4/27%OT=%CT=1%CU=40586%PV=Y%DS=1%DC=D%G=N%M=025743%TM=6088592A%P=x86_64-pc-linux-gnu)
  SEQ(CI=Z)
  T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
  T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
  T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
  U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)
  IE(R=Y%DFI=N%T=40%CD=S)

  Network Distance: 1 hop

  TRACEROUTE
  HOP RTT ADDRESS
  1 0.84 ms ip-10-10-124-182.eu-west-1.compute.internal (10.10.124.182)

  Read data files from: /usr/bin/../share/nmap
  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .

  # Nmap done at Tue Apr 27 19:34:18 2021 -- 1 IP address (1 host up) scanned in 4.65 seconds
  ```

- Input: Scan all ports
  ```bash
  nmap -p- -A -sC -sV -oA /nmap 10.10.124.182
  ```
- Output:

  ```bash
  # Nmap 7.60 scan initiated Tue Apr 27 19:20:26 2021 as: nmap -p- -A -sC -sV -oA nmap/ -vv 10.10.124.182
  Increasing send delay for 10.10.124.182 from 0 to 5 due to 4655 out of 15515 dropped probes since last increase.
  Increasing send delay for 10.10.124.182 from 5 to 10 due to 11 out of 31 dropped probes since last increase.
  Increasing send delay for 10.10.124.182 from 10 to 20 due to 11 out of 24 dropped probes since last increase.
  Increasing send delay for 10.10.124.182 from 20 to 40 due to 11 out of 23 dropped probes since last increase.
  Increasing send delay for 10.10.124.182 from 40 to 80 due to 11 out of 32 dropped probes since last increase.
  adjust_timeouts2: packet supposedly had rtt of -175564 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175564 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175516 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175516 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175611 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175611 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175646 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175646 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175647 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175647 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175631 microseconds.  Ignoring time.
  adjust_timeouts2: packet supposedly had rtt of -175631 microseconds.  Ignoring time.
  Nmap scan report for ip-10-10-124-182.eu-west-1.compute.internal (10.10.124.182)
  Host is up, received arp-response (0.00042s latency).
  Scanned at 2021-04-27 19:20:27 BST for 5814s
  Not shown: 65534 closed ports
  Reason: 65534 resets
  PORT     STATE SERVICE REASON         VERSION
  8012/tcp open  unknown syn-ack ttl 64
  | fingerprint-strings:
  |   DNSStatusRequest, DNSVersionBindReq, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, X11Probe:
  |_    SKIDY'S BACKDOOR. Type .HELP to view commands
  1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
  SF-Port8012-TCP:V=7.60%I=7%D=4/27%Time=60886C06%P=x86_64-pc-linux-gnu%r(NU
  SF:LL,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20command
  SF:s\n")%r(GenericLines,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\
  SF:x20view\x20commands\n")%r(GetRequest,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\
  SF:x20\.HELP\x20to\x20view\x20commands\n")%r(HTTPOptions,2E,"SKIDY'S\x20BA
  SF:CKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(RTSPRequest,
  SF:2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n
  SF:")%r(RPCCheck,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view
  SF:\x20commands\n")%r(DNSVersionBindReq,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\
  SF:x20\.HELP\x20to\x20view\x20commands\n")%r(DNSStatusRequest,2E,"SKIDY'S\
  SF:x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(Help,2E
  SF:,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")
  SF:%r(SSLSessionReq,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20v
  SF:iew\x20commands\n")%r(TLSSessionReq,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x
  SF:20\.HELP\x20to\x20view\x20commands\n")%r(Kerberos,2E,"SKIDY'S\x20BACKDO
  SF:OR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(SMBProgNeg,2E,"S
  SF:KIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(
  SF:X11Probe,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20c
  SF:ommands\n")%r(FourOhFourRequest,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.
  SF:HELP\x20to\x20view\x20commands\n")%r(LPDString,2E,"SKIDY'S\x20BACKDOOR\
  SF:.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(LDAPSearchReq,2E,"S
  SF:KIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(
  SF:LDAPBindReq,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x
  SF:20commands\n")%r(SIPOptions,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP
  SF:\x20to\x20view\x20commands\n")%r(LANDesk-RC,2E,"SKIDY'S\x20BACKDOOR\.\x
  SF:20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(TerminalServer,2E,"SKI
  SF:DY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands\n")%r(NC
  SF:P,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20view\x20commands
  SF:\n")%r(NotesRPC,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HELP\x20to\x20vi
  SF:ew\x20commands\n")%r(JavaRMI,2E,"SKIDY'S\x20BACKDOOR\.\x20Type\x20\.HEL
  SF:P\x20to\x20view\x20commands\n");
  MAC Address: 02:57:43:51:12:55 (Unknown)
  No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
  TCP/IP fingerprint:
  OS:SCAN(V=7.60%E=4%D=4/27%OT=8012%CT=1%CU=34686%PV=Y%DS=1%DC=D%G=Y%M=025743
  OS:%TM=60886CA1%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=109%TI=Z%CI=Z%TS
  OS:=A)SEQ(SP=105%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M2301ST11NW7%O2=M
  OS:2301ST11NW7%O3=M2301NNT11NW7%O4=M2301ST11NW7%O5=M2301ST11NW7%O6=M2301ST1
  OS:1)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%
  OS:W=F507%O=M2301NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R
  OS:=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W
  OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
  OS:T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%U
  OS:N=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

  Uptime guess: 7.535 days (since Tue Apr 20 08:07:06 2021)
  Network Distance: 1 hop
  TCP Sequence Prediction: Difficulty=261 (Good luck!)
  IP ID Sequence Generation: All zeros

  TRACEROUTE
  HOP RTT ADDRESS
  1 0.42 ms ip-10-10-124-182.eu-west-1.compute.internal (10.10.124.182)

  Read data files from: /usr/bin/../share/nmap
  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .

  # Nmap done at Tue Apr 27 20:57:21 2021 -- 1 IP address (1 host up) scanned in 5815.19 seconds

  ```

- Information
  ```bash
  PORT     STATE SERVICE REASON         VERSION
  8012/tcp open  unknown syn-ack ttl 64
  | fingerprint-strings:
  |   DNSStatusRequest, DNSVersionBindReq, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, X11Probe:
  |_    SKIDY'S BACKDOOR.
  ```

## Exploitation

- Connecting via Telnet
  - telnet 10.10.124.182 8012
  - We are greeted with a Banner, but no information is being returned.
    ```bash
    Trying 10.10.124.182...
    Connected to 10.10.124.182.
    Escape character is '^]'.
    SKIDY'S BACKDOOR. Type .HELP to view commands
    ls
    pwd
    ```
